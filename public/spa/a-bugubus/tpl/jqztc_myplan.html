<ui-view ng-controller="myplan">
    <style>
            .spinner svg {
                width: 38px;
                height: 38px;
                stroke: green;
                fill: green;
            }
    </style>
    <div class="myplan">
        <ion-content>

                    <!-- 下拉刷新 -->
                    <ion-refresher pulling-text="下拉刷新" pulling-icon="ion-android-bus" on-refresh="doRefreshTicket()" spinner="lines"></ion-refresher>

                    <!-- 过滤器  -->
                    <div class="ticketFilter">

                        <div class="row">

                            <div class="col">
                                <label class="item item-radio">
                                    <input type="radio" name="group" ng-model="q" checked="checked">
                                    <div class="radio-content">
                                        <div class="item-content">
                                            全部
                                        </div>
                                        <i class="radio-icon ion-ios-checkmark" style="color:#E91E63"></i>
                                    </div>
                                </label>
                            </div>
                        
                            <div class="col">
                                <label class="item item-radio">
                                    <input type="radio" name="group" ng-model="q"  value="2" checked="checked">
                                    <div class="radio-content">
                                        <div class="item-content">
                                            未使用
                                        </div>
                                        <i class="radio-icon ion-ios-checkmark" style="color:#E91E63"></i>
                                    </div>
                                </label>
                            </div>
                        
                            <div class="col">
                                <label class="item item-radio">
                                    <input type="radio" name="group" ng-model="q"  value="4" checked="checked">
                                    <div class="radio-content">
                                        <div class="item-content">
                                            退款中
                                        </div>
                                        <i class="radio-icon ion-ios-checkmark" style="color:#E91E63"></i>
                                    </div>
                                </label>
                            </div>

                        </div>

                    </div>

                    <!-- 有票 -->
                    <ion-list ng-if="!ticketsInfoIsEmpty">
                        <!-- 分类 -->
                        <ion-item class="animate-repeat" ng-repeat="item in ticketsInfo  | filter: {viewOrderStatus:q} as results" ng-switch="item.viewOrderStatus">

                            <!-- 2 未使用  -->
                            <div class="detail" ng-switch-when="2">
                                <div class="row info " style="padding-left: 10px;" >
                                    <div class="col">
                                        <i class="icon ion-ios-clock-outline btnfont3 blue"></i>
                                        <span class="btnfont4">{{item.departTime}}</span>
                                    </div>
                                    <div class="col" style="text-align: center">
                                        <div class="btnfont green">单程</div>
                                    </div>
                                    <div class="col" style="text-align: center">
                                        <div class="btnfont">{{item.platenum}}</div>
                                    </div>
                                    <div class="col" style="text-align: center">
                                        <span class="btnfont5">单程约{{item.drivetime}}分钟</span>
                                    </div>
                                </div>
                                <div class="row startposition">
                                    <div class="col">
                                        <i class="icon ion-record btnfont3 green"></i>
                                        {{item.departName}}
                                    </div>
                                </div>
                                <div class="row endposition">
                                    <div class="col">
                                        <i class="icon ion-record btnfont3 red "></i>
                                        {{item.arriveName}}
                                    </div>
                                </div>
                                <div class="row refund">
                                        <div class="col col-70">
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >发车地点: {{item.departaddr}}</div>
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >出发日期: {{item.departDate | date:'yyyy-MM-dd'}} {{item.departTime}}</div>
                                        </div>
                                        <div class="col ctlbtn">
                                                <button class="button button-balanced" ng-click="unusedTicketToDetail(item, i)">
                                                    详情 <i class="icon ion-ios-redo-outline"></i>
                                                </button>
                                        </div>
                                </div>
                                <div class="row" >
                                    <div class="col col-33">
                                        <i class="icon ion-android-notifications-none" style="color:deeppink"></i>
                                        未使用(支付完成)
                                    </div>
                                </div> 
                            </div>

                            <!-- 3 已使用-->
                            <div class="detail" ng-switch-when="3">
                                    <div class="row info " style="padding-left: 10px;" >
                                        <div class="col">
                                            <i class="icon ion-ios-clock-outline btnfont3 blue"></i>
                                            <span class="btnfont4">{{item.departTime}}</span>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont green">单程</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont">{{item.platenum}}</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <span class="btnfont5">单程约{{item.drivetime}}分钟</span>
                                        </div>
                                    </div>
                                    <div class="row startposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 green"></i>
                                            {{item.departName}}
                                        </div>
                                    </div>
                                    <div class="row endposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 red "></i>
                                            {{item.arriveName}}
                                        </div>
                                    </div>
                                    <div class="row refund">
                                        <div class="col col-70">
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >发车地点: {{item.departaddr}}</div>
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >出发日期: {{item.departDate | date:'yyyy-MM-dd'}} {{item.departTime}}</div>
                                        </div>
                                        <div class="col ctlbtn">
                                                <button class="button button-stable"  ng-click="usedTicketToComment(item, i)">
                                                    <span ng-if="item.orderhie == null">写评价 <i class="icon ion-ios-compose-outline"></i></span>
                                                    <span ng-if="item.orderhie != null">详情 <i class="icon ion-ios-compose-outline"></i></span>
                                                </button>
                                        </div>
                                     </div>
                                     <div class="row" >
                                        <div class="col col-33">
                                            <i class="icon ion-android-notifications-none" style="color:deeppink"></i>
                                            已使用<span ng-if="item.orderhie == null">(未评价)</span><span ng-if="item.orderhie != null">(已评价)</span>
                                        </div>
                                    </div> 
                            </div>

                            <!-- 4 退款中 -->
                            <div class="detail" ng-switch-when="4">
                                    <div class="row info " style="padding-left: 10px;" >
                                        <div class="col">
                                            <i class="icon ion-ios-clock-outline btnfont3 blue"></i>
                                            <span class="btnfont4">{{item.departTime}}</span>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont green">单程</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont">{{item.platenum}}</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <span class="btnfont5">单程约{{item.drivetime}}分钟</span>
                                        </div>
                                    </div>
                                    <div class="row startposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 green"></i>
                                            {{item.departName}}
                                        </div>
                                    </div>
                                    <div class="row endposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 red "></i>
                                            {{item.arriveName}}
                                        </div>
                                    </div>
                                    <div class="row refund">
                                        <div class="col col-70">
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >发车地点: {{item.departaddr}}</div>
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >出发日期: {{item.departDate | date:'yyyy-MM-dd'}} {{item.departTime}}</div>
                                        </div>
                                        <div class="col ctlbtn">
                                                <button class="button button-balanced"  ng-click="refundingToRefund(item, i)">
                                                    详情 <i class="icon ion-ios-redo-outline"></i>
                                                </button>
                                        </div>
                                     </div>
                                    <div class="row" >
                                        <div class="col col-33">
                                            <i class="icon ion-android-notifications-none" style="color:deeppink"></i>
                                            正在退款中
                                        </div>
                                    </div> 
                            </div>

                            <!-- 5 已退款  -->
                            <div class="detail" ng-switch-when="5" style="opacity: 0.5;">
                                    <div class="row info " style="padding-left: 10px;" >
                                        <div class="col">
                                            <i class="icon ion-ios-clock-outline btnfont3 blue"></i>
                                            <span class="btnfont4">{{item.departTime}}</span>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont green">单程</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <div class="btnfont">{{item.platenum}}</div>
                                        </div>
                                        <div class="col" style="text-align: center">
                                            <span class="btnfont5">单程约{{item.drivetime}}分钟</span>
                                        </div>
                                    </div>
                                    <div class="row startposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 green"></i>
                                            {{item.departName}}
                                        </div>
                                    </div>
                                    <div class="row endposition">
                                        <div class="col">
                                            <i class="icon ion-record btnfont3 red "></i>
                                            {{item.arriveName}}
                                        </div>
                                    </div>
                                    <div class="row refund">
                                        <div class="col col-70">
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >发车地点: {{item.departaddr}}</div>
                                            <div style="margin: 0 0 8px 11px;white-space: normal;" >出发日期: {{item.departDate | date:'yyyy-MM-dd'}} {{item.departTime}}</div>
                                        </div>
                                        <!-- <div class="col ctlbtn">
                                                <button class="button button-stable">
                                                    查看详情
                                                </button>
                                        </div>  -->
                                     </div>
                                     <div class="row" >
                                        <div class="col col-33">
                                            <i class="icon ion-android-notifications-none" style="color:deeppink"></i>
                                            已退款 ￥{{item.payPrice}}
                                        </div>
                                    </div> 
                            </div>

                        </ion-item>

                        <!-- 无相关票提醒 -->
                        <ion-item class="animate-repeat" ng-if="results.length === 0">
                            
                            <!-- 没有相关票据信息 -->
                            <div class="detail">
                                <div class="row" style="text-align: center;font-size: 18px;">
                                    <div class="col">
                                        <i class="icon ion-ios-information-outline" style="color:crimson;font-size: 18px;"></i>
                                        <span style="font-size: 12px;">没有相关车票信息</span>
                                    </div>
                                </div> 
                            </div>
                        </ion-item>

                    </ion-list>

                    <!-- 无票 -->
                    <ion-list ng-if="ticketsInfoIsEmpty">
                            <!-- 无票提醒 -->
                            <ion-item class="animate-repeat">
                                <!-- 没有任何票据信息 -->
                                <div class="detail">
                                        <div class="row" style="text-align: center;font-size: 18px;">
                                            <div class="col">
                                                <i class="icon ion-ios-information" style="color:crimson;font-size: 18px;"></i>
                                                <span style="font-size: 12px;">您还没有购买任何车票</span>
                                            </div>
                                        </div> 
                                </div>
                            </ion-item>
                    </ion-list>

                    <!-- 上拉加载 -->
                    <ion-infinite-scroll ng-if="hasmore" on-infinite="loadMoreTicket()" distance="5%" spinner="dots"></ion-infinite-scroll>

                </ion-content>
    </div>

</ui-view>